"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[667],{1393:(n,e,t)=>{t.d(e,{OS:()=>s,Ww:()=>a,b$:()=>l});var r=t(7154),i=t(3401),o=t(7459);const a=async n=>{let{images:e}=n;try{const n=(0,o.gf)();return(await r.A.put("/api/posts/upload",{images:e},{headers:{Authorization:"Bearer ".concat(n)}})).data}catch(a){var t;console.log(a),401===(null===a||void 0===a||null===(t=a.response)||void 0===t?void 0:t.status)&&(i.oR.error("\ud30c\uc77c \uc0ad\uc81c \uc911 \uc5d0\ub7ec\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694"),window.location.reload())}},s=async n=>{let{formData:e}=n;try{const n=(0,o.gf)();return(await r.A.post("/api/posts/upload",e,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(n)}})).data}catch(a){var t;401===(null===a||void 0===a||null===(t=a.response)||void 0===t?void 0:t.status)&&(i.oR.error("\uc5c5\ub85c\ub4dc\uc911 \uc5d0\ub7ec\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694"),window.location.reload())}},l=async n=>{let{formData:e}=n;try{const n=(0,o.gf)();return(await r.A.post("/api/users/edit/avatar",e,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(n)}})).data}catch(a){var t;return 401===(null===a||void 0===a||null===(t=a.response)||void 0===t?void 0:t.status)&&(i.oR.error("\uc5c5\ub85c\ub4dc\uc911 \uc5d0\ub7ec\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694"),window.location.reload()),""}}},7961:(n,e,t)=>{t.d(e,{f:()=>r});const r=(0,t(831).eU)({key:"fileObjectState",default:[]})},3026:(n,e,t)=>{t.d(e,{A:()=>l});var r,i=t(7528),o=t(197),a=t(579);const s=o.Ay.div(r||(r=(0,i.A)(["\n  display: flex;\n  flex-direction: ",";\n  justify-content: ",";\n  align-items: ",";\n  flex-wrap: ",";\n  gap: ",";\n  padding: ",";\n  background: ",";\n"])),(n=>{let{$direction:e}=n;return e||"row"}),(n=>{let{$justifyContent:e}=n;return e||"flex-start"}),(n=>{let{$alignItems:e}=n;return e||"stretch"}),(n=>{let{$wrap:e}=n;return e||"nowrap"}),(n=>{let{$gap:e}=n;return e||"0"}),(n=>{let{$padding:e}=n;return e}),(n=>{let{$background:e}=n;return e||"transparent"})),l=n=>{let{children:e,$direction:t,$justifyContent:r,$alignItems:i,$wrap:o,$gap:l,$padding:d,$background:c,style:p}=n;return(0,a.jsx)(s,{$direction:t,$justifyContent:r,$alignItems:i,$wrap:o,$gap:l,$padding:d,$background:c,style:p,children:e})}},5376:(n,e,t)=>{t.d(e,{A:()=>j});var r,i,o,a,s,l,d,c,p=t(7528),u=(t(9686),t(5043)),g=t(2485),h=t(3401),x=t(197),f=t(579);const m=x.Ay.div(r||(r=(0,p.A)(["\n  z-index: 20;\n  position: fixed;\n  left: 0;\n  top: 0;\n  width: 100vw;\n  height: 100vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  .cropper-crop-box,\n  .cropper-view-box {\n    ","\n  }\n\n  .cropper-view-box {\n    ","\n  }\n"])),(n=>{let{profileimg:e}=n;return e&&(0,x.AH)(i||(i=(0,p.A)(["\n        border-radius: 50%;\n      "])))}),(n=>{let{profileimg:e}=n;return e&&(0,x.AH)(o||(o=(0,p.A)(["\n        box-shadow: 0 0 0 1px #39f;\n        outline: 0;\n      "])))})),A=x.Ay.div(a||(a=(0,p.A)(["\n  position: inherit;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.8);\n  backdrop-filter: blur(8px);\n"]))),y=x.Ay.div(s||(s=(0,p.A)(["\n  z-index: 2;\n  background: #ffffff;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n\n  .title {\n    font-weight: 600;\n    line-height: 26px;\n    padding: 20px 16px;\n    text-align: center;\n    color: black;\n    margin: 0;\n  }\n"]))),b=x.Ay.div(l||(l=(0,p.A)(["\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: #ffffff;\n"]))),w=x.Ay.div(d||(d=(0,p.A)(["\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: white;\n"]))),v=x.Ay.div(c||(c=(0,p.A)(["\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  padding: 20px 16px;\n  background: #ffffff;\n  column-gap: 12px;\n\n  button {\n    width: 100px;\n    height: 40px;\n    border: 1px solid #c3c3c3;\n    border-radius: 4px;\n    background: white;\n  }\n\n  .crop {\n    background: #cf3e58;\n    color: white;\n    border: none;\n  }\n"]))),j=n=>{let{children:e,aspectRatio:t,onCrop:r,profileImg:i=!1}=n;const o=(0,u.useRef)(null),a=(0,u.useRef)(null),[s,l]=(0,u.useState)(null);return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("input",{type:"file",ref:o,multiple:!0,style:{display:"none"},onChange:n=>{n.preventDefault();const e=n.target.files;if(!e||0===e.length)return;if(!e[0].type.startsWith("image/"))return void h.oR.warning("\uc774 \ud30c\uc77c\uc740 \uc774\ubbf8\uc9c0\uac00 \uc544\ub2d9\ub2c8\ub2e4.");const t=new FileReader;t.onload=()=>{l(t.result)},t.readAsDataURL(e[0])},onClick:n=>{n.target.value=""}}),(0,f.jsx)("span",{onClick:()=>{o.current&&o.current.click()},children:e}),s&&(0,f.jsxs)(m,{profileimg:!0===i?"true":"",children:[(0,f.jsx)(A,{}),(0,f.jsxs)(y,{children:[(0,f.jsx)("h3",{className:"title",children:"\uc774\ubbf8\uc9c0 \ud3b8\uc9d1\ud558\uae30"}),(0,f.jsx)(b,{children:(0,f.jsx)(w,{children:(0,f.jsx)(g.I,{ref:a,aspectRatio:t&&t,initialAspectRatio:1,src:s,viewMode:1,width:800,height:500,background:!1,responsive:!0,autoCropArea:1,checkOrientation:!1,guides:!0})})}),(0,f.jsxs)(v,{children:[(0,f.jsx)("button",{onClick:()=>l(null),children:"\ucde8\uc18c"}),(0,f.jsx)("button",{className:"crop",onClick:()=>{var n;if("undefined"!==typeof(null===(n=a.current)||void 0===n?void 0:n.cropper)){const n=a.current.cropper.getCroppedCanvas().toDataURL();r(n),l(null)}},children:"\uc801\uc6a9\ud558\uae30"})]})]})]})]})}},1207:(n,e,t)=>{t.d(e,{A:()=>h});var r,i,o=t(7528),a=t(5394),s=t(3216),l=t(3026),d=t(3704),c=t(197),p=t(579);const u=c.Ay.div(r||(r=(0,o.A)(["\n  max-width: ",";\n  max-width: 100%;\n  margin: 0 auto;\n  position: fixed;\n  left: 0;\n  right: 0;\n  top: 0;\n  z-index: 10;\n\n  &::before {\n    background-color: rgb(54, 54, 54);\n    bottom: -1px;\n    content: '';\n    height: 1px;\n    left: 0;\n    position: absolute;\n    right: 0;\n  }\n\n  @media (min-width: 768px) {\n    max-width: 500px;\n  }\n"])),(n=>{let{$pathname:e}=n;return e?"100%":"500px"})),g=c.Ay.div(i||(i=(0,o.A)(["\n  color: white;\n  font-size: 1.5rem;\n  z-index: 10;\n  cursor: pointer;\n"]))),h=n=>{let{text:e}=n;const t=(0,s.Zp)(),r=(0,s.zy)();return(0,p.jsx)(u,{$pathname:"/posts"===r.pathname?"true":"",children:(0,p.jsxs)(l.A,{$alignItems:"center",$justifyContent:"space-between",$background:"black",$padding:"5px 16px",children:[(0,p.jsx)(g,{onClick:()=>{"default"===r.key?t("/posts"):t(-1)},children:(0,p.jsx)(a.zrQ,{})}),(0,p.jsx)(d.A,{tag:"p",fontWeight:"bold",fontSize:"16px",children:e}),(0,p.jsx)("div",{})]})})}},3704:(n,e,t)=>{t.d(e,{A:()=>d});var r,i=t(7528),o=t(5043),a=t(197),s=t(579);const l=(0,a.Ay)((n=>{let{tag:e,children:t,...r}=n;return(0,o.createElement)(e,r,t)}))(r||(r=(0,i.A)(["\n  color: rgb(245, 245, 245);\n"]))),d=n=>{let{tag:e="p",children:t,...r}=n;return(0,s.jsx)(l,{tag:e,style:{...r},children:t})}},9855:(n,e,t)=>{t.d(e,{A:()=>Z});var r,i,o,a,s=t(7528),l=t(5376),d=t(446),c=t(5043),p=t(5394),u=t(3401),g=t(8222),h=t.n(g),x=t(831),f=t(197),m=t(7961),A=t(4348),y=t(1296),b=(t(4014),t(4975)),w=t(579);const v=f.Ay.div(r||(r=(0,s.A)(["\n  width: 100%;\n  cursor: pointer;\n"]))),j=f.Ay.div(i||(i=(0,s.A)(["\n  position: relative;\n  width: 220px;\n  aspect-ratio: auto 1/1;\n  margin: 0 auto;\n\n  @media (max-width: 768px) {\n    width: 190px;\n  }\n  @media (max-width: 375px) {\n    width: 140px;\n  }\n"]))),k=f.Ay.img(o||(o=(0,s.A)(["\n  width: 100%;\n  height: 100%;\n  border-radius: 5px;\n  cursor: pointer;\n"]))),$=(0,f.Ay)(d.P.button)(a||(a=(0,s.A)(["\n  position: absolute;\n  top: 10px;\n  right: 10px;\n  font-size: 20px;\n  color: white;\n  background-color: black;\n  border-radius: 50%;\n  width: 25px;\n  height: 25px;\n  z-index: 10;\n"]))),C=n=>{let{images:e,handleCompressImageDelete:t}=n;const[r,i]=(0,c.useState)(""),o=(0,c.useRef)(null);return(0,c.useEffect)((()=>{null!==o&&void 0!==o&&o.current&&o.current.swiper.slideTo(e.length-1)}),[e]),(0,w.jsx)(v,{children:(0,w.jsx)(b.RC,{ref:o,spaceBetween:0,slidesPerView:2,children:e.map(((n,e)=>(0,w.jsx)(b.qr,{children:(0,w.jsxs)(j,{children:[(0,w.jsx)($,{onClick:()=>t(e),whileTap:{scale:.8},transition:{duration:.2},children:(0,w.jsx)(p.$8F,{})}),(0,w.jsx)(k,{src:n,alt:"img-preview"})]})},e)))})})};var z,R,I,S,T,B;const D=f.Ay.div(z||(z=(0,s.A)([""]))),L=f.Ay.div(R||(R=(0,s.A)([""]))),E=f.Ay.button(I||(I=(0,s.A)(["\n  padding: 0.5rem;\n  margin: 0.5rem 0;\n  color: #afe4f8;\n  border: 1px solid rgb(38, 38, 38);\n"]))),F=f.Ay.img(S||(S=(0,s.A)(["\n  width: 100%;\n  height: 100%;\n  border-radius: 5px;\n  aspect-ratio: auto 1/1;\n"]))),P=f.Ay.div(T||(T=(0,s.A)(["\n  text-align: center;\n"]))),M=(0,f.Ay)(d.P.button)(B||(B=(0,s.A)(["\n  position: absolute;\n  top: 10px;\n  right: 10px;\n  bottom: 0;\n  font-size: 20px;\n  color: white;\n  background-color: black;\n  border-radius: 50%;\n  width: 25px;\n  height: 25px;\n  z-index: 10;\n  transition: all 0.3s ease;\n  &:hover {\n    box-shadow: 0 0 5px black;\n  }\n"]))),Z=n=>{let{deleteImages:e,oldImages:t,setDeleteImages:r}=n;const[i,o]=(0,c.useState)(null),[a,s]=(0,c.useState)(""),[d,g]=(0,c.useState)([]),{isLoading:f,compressImage:b}=(0,y.A)(),[v,j]=(0,x.L4)(m.f),k=n=>{const t=[...d],i=[...v];if(!(t[n]instanceof Blob)&&r){const i=Array.isArray(e)?[...e]:[];i.push(t[n]),r(i)}t.splice(n,1),i.splice(n,1),g(t),j(i)};return(0,c.useEffect)((()=>{i&&(async()=>{if(!i)return;const n=(0,A.A)(i),e=await b(n);if(!e)return;j((n=>[...n,e]));const t=URL.createObjectURL(e),r=[...d,t];g(r)})()}),[i,a]),(0,c.useEffect)((()=>{t&&(g([...t]),j([...t]))}),[t]),(0,w.jsx)(D,{children:(0,w.jsxs)(L,{children:[1!==d.length||f?d.length>1&&!f?(0,w.jsx)(C,{images:d,handleCompressImageDelete:k}):(0,w.jsx)(P,{children:f&&"\uc774\ubbf8\uc9c0 \uc555\ucd95 \uc911.."}):(0,w.jsxs)("div",{style:{position:"relative"},children:[(0,w.jsx)(M,{onClick:()=>k(0),whileTap:{scale:.8},transition:{duration:.2},children:(0,w.jsx)(p.$8F,{})}),(0,w.jsx)(F,{src:d[0],alt:"compressed image"})]}),(0,w.jsx)(l.A,{onCrop:n=>{if(v.length>=5)return u.oR.error("\uc774\ubbf8\uc9c0\ub294 \ucd5c\ub300 \ub2e4\uc12f\uac1c\uae4c\uc9c0\ub9cc \uc62c\ub824\uc8fc\uc138\uc694!");s(h()()),o(n)},children:(0,w.jsx)(E,{children:"\ud83d\udcf7"})})]})})}},4348:(n,e,t)=>{t.d(e,{A:()=>r});const r=n=>{const e=atob(n.split(",")[1]),t=n.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(e.length),i=new Uint8Array(r);for(let a=0;a<e.length;a++)i[a]=e.charCodeAt(a);const o=new Blob([r],{type:t});return new File([o],"uploadImage",{type:t})}},1296:(n,e,t)=>{t.d(e,{A:()=>o});var r=t(1641),i=t(5043);const o=()=>{const[n,e]=(0,i.useState)(!1);return{compressImage:async t=>{if(n)return;e(!0),console.log("\uc6d0\ubcf8 \uc774\ubbf8\uc9c0 \uc0ac\uc774\uc988 : ".concat(t.size/1024/1024," MB"));const i={maxSizeMB:2,maxWidthOrHeight:1920};try{const n=await(0,r.A)(t,i);return console.log("\uc555\ucd95\ub41c \uc774\ubbf8\uc9c0 \uc0ac\uc774\uc988 : ".concat(n.size/1024/1024," MB")),e(!1),n}catch(o){e(!1),console.log(o)}},isLoading:n}}},1685:(n,e,t)=>{t.r(e),t.d(e,{default:()=>U});var r=t(7528),i=t(446),o=t(5043),a=t(3401),s=t(831),l=t(197),d=t(1393),c=t(7961),p=t(3248),u=t(7097),g=t(5818),h=t(780),x=t(8245),f=t(3216);const m=async n=>{let{value:e,fileInfo:t,tags:r}=n;return(await g.A.post("/api/posts",{content:e,images:t,tags:r})).data},A=()=>{const n=(0,f.Zp)(),e=(0,p.jE)();return(0,u.n)({mutationFn:m,mutationKey:["postWrite"],onSuccess:t=>{e.invalidateQueries({queryKey:[x.Z.posts],refetchType:"all"}),e.invalidateQueries({queryKey:[h.h.myPosts],refetchType:"all"}),a.oR.success("\uac8c\uc2dc\ubb3c\uc774 \uc791\uc131\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),n("/posts")},onError:n=>{console.log("error:",n),a.oR.error("\uac8c\uc2dc\ubb3c \uc791\uc131 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}})};var y,b,w,v,j=t(8371),k=t(1207),$=t(9855),C=t(579);const z=l.Ay.div(y||(y=(0,r.A)(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow-y: auto;\n  overflow-x: none;\n  min-height: 168px;\n  max-height: 168px;\n  outline: none;\n"]))),R=l.Ay.div(b||(b=(0,r.A)(["\n  padding-top: 2rem;\n  color: #999;\n"]))),I=l.Ay.div(w||(w=(0,r.A)(["\n  padding-top: 2rem;\n  text-align: left;\n  width: 100%;\n  height: auto;\n  min-height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  overflow-y: visible;\n  box-sizing: border-box;\n"]))),S=l.Ay.div(v||(v=(0,r.A)(["\n  padding-top: 2rem;\n  text-align: left;\n  width: 100%;\n  height: auto;\n  min-height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  overflow-y: visible;\n  border: none;\n  outline: none;\n  box-sizing: border-box;\n  z-index: 1;\n"]))),T=n=>{let{placeholder:e,value:t,setValue:r,tags:i,setTags:o}=n;const a=n=>{const e=window.getSelection();if(e&&e.getRangeAt&&e.rangeCount){const t=e.getRangeAt(0);t.deleteContents();const r=document.createElement("div");r.innerHTML=n;const i=document.createDocumentFragment();let o,a;for(;o=r.firstChild;)a=i.appendChild(o);if(t.insertNode(i),a){const n=t.cloneRange();n.setStartAfter(a),n.setEndAfter(a),n.collapse(!0),e.removeAllRanges(),e.addRange(n)}}};return(0,C.jsxs)(z,{children:[e&&!t&&(0,C.jsx)(R,{dangerouslySetInnerHTML:{__html:e}}),(0,C.jsx)(I,{dangerouslySetInnerHTML:{__html:t}}),(0,C.jsx)(S,{contentEditable:!0,onKeyDown:n=>{if(13===n.keyCode)return n.preventDefault(),a(" \n<br>\u200b"),!1},onInput:n=>(n=>{const e=n.currentTarget.innerText.match(/#[^\s#]+/g),t=n.currentTarget.innerText.replace(/(<)/gi,"&lt;").replace(/(<)/gi,"&lg;").replace(/(?:\r\n|\n\r|\r|\n)/g,"\n<br />").replace(/#(.+?)(?=[\s.,:,]|$)/g,"<span class='hashtag'>#$1</span>").replace(/@(.+?)(?=[\s.,:,]|$)/g,"<span class='mention'>@$1</span>").replace(/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)/g,"<span>$1</span>");e&&o(e),r(t)})(n)})]})};var B,D,L,E,F;const P=l.Ay.div(B||(B=(0,r.A)(["\n  background-color: black;\n  color: rgb(245, 245, 245);\n  min-height: 100vh;\n"]))),M=l.Ay.div(D||(D=(0,r.A)(["\n  max-width: 500px;\n  width: 100%;\n  background-color: black;\n  position: fixed;\n  top: 0;\n  z-index: 20;\n"]))),Z=(0,l.Ay)(i.P.div)(L||(L=(0,r.A)(["\n  max-width: 500px;\n  margin: 0 auto;\n"]))),H=l.Ay.div(E||(E=(0,r.A)(["\n  position: relative;\n  padding: 0 1rem;\n  padding-top: 1rem;\n  border: 1px solid rgb(38, 38, 38);\n  border-radius: 5px;\n  box-shadow: 0 0 20px rgba(255, 255, 255, 0.5);\n"]))),O=(0,l.Ay)(j.A)(F||(F=(0,r.A)(["\n  position: absolute;\n  right: 0;\n  bottom: 15px;\n  width: 100px;\n\n  opacity: ",";\n  cursor: ",";\n"])),(n=>n.disabled?"0.5":"1"),(n=>n.disabled?"not-allowed":"pointer")),U=()=>{const[n,e]=(0,o.useState)(""),[t,r]=(0,o.useState)([]),[i,l]=(0,s.L4)(c.f),{mutate:p,isPending:u}=A();return(0,C.jsxs)(P,{children:[(0,C.jsx)(M,{children:(0,C.jsx)(k.A,{text:"\uac8c\uc2dc\ubb3c \uc791\uc131"})}),(0,C.jsx)(Z,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},children:(0,C.jsxs)(H,{children:[(0,C.jsx)(T,{placeholder:"\ub2f9\uc2e0\uc758 \uacf5\ucc28\ub97c \uacf5\uc720\ud558\uace0 \uc18c\uac1c\ud574\uc8fc\uc138\uc694!<br/>(\uc774\ubbf8\uc9c0\ub97c \ud558\ub098 \uc774\uc0c1 \uc5c5\ub85c\ub4dc\ud574\uc8fc\uc138\uc694)",value:n,setValue:e,tags:t,setTags:r}),(0,C.jsx)($.A,{}),(0,C.jsx)(O,{type:"submit",onClick:async()=>{if(0===i.length)return a.oR.error("\uc774\ubbf8\uc9c0\ub97c \ud558\ub098 \uc774\uc0c1 \uc5c5\ub85c\ub4dc\ud574\uc8fc\uc138\uc694!");{const e=new FormData;i.forEach(((n,t)=>{e.append("files",n)}));const r=await(0,d.OS)({formData:e});r&&0!==r.length&&(p({value:n,fileInfo:r,tags:t}),l([]))}},disabled:0===i.length,children:u?(0,C.jsx)("img",{src:"./spinner.svg",alt:"loading",className:"spinner"}):"\uc791\uc131"})]})})]})}},780:(n,e,t)=>{t.d(e,{h:()=>r});const r={myPosts:"myPosts",myBookmark:"myBookmark"}},8245:(n,e,t)=>{t.d(e,{Z:()=>r,l:()=>i});const r={posts:"posts"},i={post:"post",postLike:"postLike",postBookmark:"postBookmark"}}}]);
//# sourceMappingURL=667.39d8dbff.chunk.js.map